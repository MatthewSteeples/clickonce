{
  "id": "540cd748-7752-4245-936d-d18d292a1000",
  "name": "clickonce",
  "friendlyName": "ClickOnce Packager",
  "description": "Create and update ClickOnce packages",
  "author": "Andrew Mansell",
  "helpMarkDown": "[More Information](https://github.com/mansellan/clickonce)",
  "category": "Utility",
  "visibility": [
    "Build",
    "Release"
  ],
  "demands": [],
  "version": {
    "Major": "0",
    "Minor": "1",
    "Patch": "64"
  },
  "minimumAgentVersion": "2.116.0",
  "instanceNameFormat": "ClickOnce Package",
  "groups": [
	  {
      "name": "description",
      "displayName": "Description"
    },
	  {
      "name": "files",
      "displayName": "Application Files"
    },
		{
			"name": "updates",
			"displayName": "Updates",
			"visibleRule": "launchMode = start || launchMode = both"
		},
    {
			"name": "security",
			"displayName": "Security" 
    },
	  {
	    "name": "advanced",
	    "displayName": "Advanced"
	  }
  ],
	"inputs": [
		{
			"name": "source",
			"type": "filePath",
			"label": "Source path",
			"helpMarkDown": "Specifies the base directory for all source globbing patterns."
		},
		{
			"name": "target",
			"type": "string",
			"label": "Target path",
			"defaultValue": "publish",
			"required": true,
			"helpMarkDown": "Specifies the directory to which ClickOnce packages will be published. If a relative path is specified, it will be relative to the Source directory. This directory will be automatically excluded from all source globbing patterns."
		},
		{
			"name": "product",
			"type": "string",
			"label": "Application name",
			"required": true,
			"helpMarkDown": "Specifies the name of the application. This name is used for the shortcut name on the Start menu and is part of the name that appears in the Add or Remove Programs dialog box."
		},
		{
			"name": "version",
			"type": "string",
			"label": "Version",
			"helpMarkDown": "Specifies the version of the deployment. This need not be (and usually isn't) the same as the version of the application. Must be a dotted version number with 1 to 4 elements, each less than 63356. If not specified, the version number of the EntryPoint is used."
		},
		{
			"name": "publisher",
			"type": "string",
			"label": "Publisher",
			"required": true,
			"helpMarkDown": "Specifies the publisher of the application. This name is used for the folder name on the Start menu and is part of the name that appears in the Add or Remove Programs dialog box."
		},
		{
			"name": "launchMode",
			"type": "pickList",
			"label": "Launch mode",
			"defaultValue": "start",
			"required": true,
			"helpMarkDown": "Specifies whether the application can be launched from the Start menu, from a URL, or both. Also allows browser-hosted deployments (Internet Explorer only).",
			"options": {
				"start": "Launchable from Start menu",
				"url": "Launchable from a URL (Internet Explorer / Edge only)",
				"both": "Launchable from Start menu or a URL",
				"browser": "Browser-hosted (Internet Explorer only)"
			}
		},
		{
			"name": "createDesktopShortcut",
			"type": "boolean",
			"label": "Create desktop shortcut",
			"defaultValue": false,
			"helpMarkDown": "Specifies whether a shortcut to the application should be added to the user's desktop.",
			"visibleRule": "launchMode = start || launchMode = both"
		},
		{
			"name": "createAutoRun",
			"type": "boolean",
			"label": "Create autorun.inf file",
			"defaultValue": false,
			"helpMarkDown": "Specifies whether or not to create an autorun.inf to launch the ClickOnce installer when deployed to removable media.",
			"visibleRule": "launchMode = start || launchMode = both"
		},
		{
			"name": "useDeployExtension",
			"type": "boolean",
			"label": "Use .deploy extension",
			"defaultValue": true,
			"helpMarkDown": "Specifies whether the .deploy file name extension mapping is used. If this parameter is true, every program file is published with a .deploy file name extension. This option is useful for web server security to limit the number of file name extensions that must be unblocked to enable ClickOnce application deployment."
		},
		{
			"name": "trustUrlParameters",
			"type": "boolean",
			"label": "Trust URL parameters",
			"defaultValue": true,
			"helpMarkDown": "Specifies whether URL query-string parameters should be made available to the application.",
			"visibleRule": "launchMode = url || launchMode = both"
		},
		{
			"name": "deploymentUrl",
			"type": "string",
			"label": "Deployment URL",
			"required": true,
			"helpMarkDown": "Specifies the URL that will be used to distribute and update the application. Must be a valid and absolute URI (a URL or a UNC).",
			"visibleRule": "launchMode = start || launchMode = both"
		},
		{
			"name": "description",
			"type": "string",
			"label": "Description",
			"groupName": "description",
			"helpMarkDown": "Specifies a description for the application."
		},
		{
			"name": "suite",
			"type": "string",
			"label": "Suite",
			"groupName": "description",
			"helpMarkDown": "Specifies the name of the suite to which the application belongs. If specified, this determines the folder on the Start menu where the application is located after deployment."
		},
		{
			"name": "culture",
			"type": "string",
			"label": "Culture",
			"defaultValue": "neutral",
			"groupName": "description",
			"helpMarkDown": "Specifies the culture of the application. Must be 'neutral' or a valid culture (e.g. 'en-GB'). If not specified, the culture of the EntryPoint is used."
		},
		{
			"name": "errorUrl",
			"type": "string",
			"label": "Error URL",
			"groupName": "description",
			"helpMarkDown": "Specifies the URL of the web page that is displayed in dialog boxes during ClickOnce installation. Must be a valid and absolute URI (a URL or a UNC)."
		},
		{
			"name": "supportUrl",
			"type": "string",
			"label": "Support URL",
			"groupName": "description",
			"helpMarkDown": "Specifies the URL of the web page that is displayed in the Add or Remove Programs dialog box for the application. Must be a valid and absolute URI (a URL or a UNC)."
		},
		{
			"name": "targetFramework",
			"type": "pickList",
			"label": "Target framework",
			"required": true,
			"defaultValue": "net472",
			"groupName": "files",
			"helpMarkDown": "Specifies the target framework of the application.",
			"options": {
				"net20": "net20",
				"net30": "net30",
				"net35": "net35",
				"net40": "net40",
				"net45": "net45",
				"net451": "net451",
				"net452": "net452",
				"net46": "net46",
				"net461": "net461",
				"net462": "net462",
				"net47": "net47",
				"net471": "net471",
				"net472": "net472",
				"net48": "net48"
			}
		},
		{
			"name": "entryPoint",
			"type": "filePath",
			"label": "Entry point",
			"groupName": "files",
			"helpMarkDown": "Specifies the application assembly that starts when the application is run. Must be an .exe file. If this is not a .Net Framework assembly, a launcher must be used via the UseLauncher option. If not specified, the source directory is recursively searched for .exe files. If exactly one is found, it will be assigned to be the entry point."
		},
		{
			"name": "iconFile",
			"type": "filePath",
			"label": "Icon file",
			"groupName": "files",
			"helpMarkDown": "Specifies the application icon file. This is used for the Start Menu and Add/Remove Programs dialog. Must be an .ico file. If not specified, the source directory is recursively searched for .ico files. If exactly one is found it is used; otherwise, a default icon is used."
		},
		{
			"name": "deploymentPage",
			"type": "string",
			"label": "Deployment page",
			"groupName": "files",
			"defaultValue": "install.htm",
			"helpMarkdown": "Specifies the name of the deployment page to create. If not specified, no deployment page will be created."
		},
		{
			"name": "assemblies",
			"type": "multiLine",
			"label": "Assemblies",
			"groupName": "files",
			"defaultValue": "**/*.exe\r\n**/*/.dll",
			"helpMarkDown": "Specifies a list of globbing patterns to match assemblies to be included. Will only consider managed assemblies, hence a pattern of *.dll will exclude native libraries."
		},
		{
			"name": "dataFiles",
			"type": "multiLine",
			"label": "Data files",
			"groupName": "files",
			"defaultValue": "**/*.mdb",
			"helpMarkDown": "Specifies a list of globbing patterns to match data files to be included. Will not include any files already added as assemblies. These files are considered mutable, and can be migrated between application versions."
		},
		{
			"name": "files",
			"type": "multiLine",
			"label": "Files",
			"groupName": "files",
			"defaultValue": "**/*",
			"helpMarkDown": "Specifies a list of globbing patterns to match non-assembly files to be included.  Will not include any files already added as assemblies or data files."
		},
		{
			"name": "optionalFilesPath",
			"type": "string",
			"label": "Optional files path",
			"groupName": "files",
			"defaultValue": "Optional",
			"helpMarkDown": "Specifies a path under which optional files are stored, relative to the source path. The first level of directories under this path will be used as the group names for the optional download groups. The DataFiles glob will be ignored for this path, as data files cannot be optional."
		},
		{
			"name": "updateMode",
			"type": "pickList",
			"label": "Update mode",
			"groupName": "updates",
			"defaultValue": "starting",
			"helpMarkDown": "Specifies how application updates should be deployed.",
			"options": {
				"none": "Do not update application",
				"starting": "Check before application launches",
				"started": "Check after application launches",
				"scheduled": "Check on a scheduled basis"
			}
		},
		{
			"name": "updateInterval",
			"type": "string",
			"label": "Interval",
			"groupName": "updates",
			"defaultValue": "7",
			"helpMarkDown": "Specifies the update interval.",
			"visibleRule": "updateMode = scheduled"
		},
		{
			"name": "updateUnit",
			"type": "pickList",
			"label": "Unit",
			"groupName": "updates",
			"defaultValue": "days",
			"helpMarkDown": "Specifies the update unit.",
			"visibleRule": "updateMode = scheduled",
			"options": {
				"hours": "Hour(s)",
				"days": "Day(s)",
				"weeks": "Week(s)"
			}
		},
		{
			"name": "minimumVersion",
			"type": "string",
			"label": "Minimum version",
			"groupName": "updates",
			"helpMarkdown": "Specifies the minimum version the user must update to when starting the application. Must be a dotted version number with 1 to 4 elements, each less than 63356. Must be equal to or lower than Version. If not specified and UpdateMode is not 'none', defaults to Version.",
			"visibleRule": "updateMode = starting || updateMode = started || updateMode = scheduled"
		},
		{
			"name": "signingMode",
			"type": "pickList",
			"label": "Signing mode",
			"groupName": "security",
			"helpMarkDown": "Specifies the signing mode to be applied.",
			"options": {
				"none": "Do not sign",
				"installed": "Sign with an installed certificate",
				"file": "Sign with a certificate file"
			},
			"defaultValue": "none"
		},
		{
			"name": "thumbprint",
			"type": "string",
			"label": "Thumbprint",
			"groupName": "security",
			"required": true,
			"helpMarkDown": "Specifies the thumbprint of the installed certificate.",
			"visibleRule": "signingMode = installed"
		},
		{
			"name": "certificate",
			"type": "secureFile",
			"label": "Certificate",
			"groupName": "security",
			"required": true,
			"helpMarkDown": "Specifies the certificate to use. Add this as a secure file.",
			"visibleRule": "signingMode = file"
		},
		{
			"name": "certificatePassword",
			"type": "string",
			"label": "Password",
			"groupName": "security",
			"required": true,
			"helpMarkDown": "Specifies the password for the certificate. To secure this value, set it up as a variable and lock it with the padlock.",
			"visibleRule": "signingMode = file"
		},
		{
			"name": "timestampUrl",
			"type": "string",
			"label": "Timestamp URL",
			"groupName": "security",
			"helpMarkDown": "Specifies the URL of a server to timestamp the signature.",
			"visibleRule": "signingMode = installed || signingMode = file"
		},
		{
			"name": "useApplicationTrust",
      "type": "boolean",
      "label": "Use application trust",
      "defaultValue": false,
      "groupName": "advanced",
      "helpMarkDown": "Specifies which manifest should be used for trust decisions. If true, the Product, Publisher, and SupportUrl properties are written to the application manifest; otherwise, they are written to the deployment manifest."
    },
		{
			"name": "identity",
			"type": "string",
			"label": "Identity",
			"defaultValue": null,
			"groupName": "advanced",
			"helpMarkDown": "Specifies the identity name of the application. This is used for the application and deployment manifest file names and the package folder name. If not specified, a name is inferred from the EntryPoint."
		},
		{
			"name": "useLauncher",
			"type": "pickList",
			"label": "Launcher",
			"defaultValue": "auto",
			"groupName": "advanced",
			"helpMarkDown": "Specifies whether or not a launcher should be created.",
			"options": {
				"true": "Always create a launcher",
				"false": "Never create a launcher",
				"auto": "Create a launcher if the entry point is not a .Net Framework assembly"
			}
		},
		{
			"name": "verbosity",
			"type": "pickList",
			"label": "Verbosity",
			"defaultValue": "normal",
			"groupName": "advanced",
			"helpMarkDown": "Specifies the level of logging to emit",
			"options": {
				"quiet": "Quiet",
				"normal": "Normal",
				"verbose": "Verbose"
			}
		}
	],
  "execution": {
    "Node10": {
      "target": "clickonce.js"
    }
  }
}